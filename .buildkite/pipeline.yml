steps:
  - name: ":golangci-lint: lint"
    plugins:
      docker-compose#v4.14.0:
        config: .buildkite/docker-compose.yaml
        run: lint

  - name: "Test"
    command: "go test -v -failfast ./..."
    skip: true
    plugins:
      docker-compose#v3.0.0:
        config: .buildkite/docker-compose.yml
        run: agent

  - wait

  - label: ":buildkite: build"
    artifact_paths:
      - dist/**/*
    plugins:
      docker-compose#v4.14.0:
        config: .buildkite/docker-compose.yaml
        run: build
